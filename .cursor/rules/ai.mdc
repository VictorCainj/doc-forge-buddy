---
description: Regras para integra√ß√£o com IA (OpenAI API)
---

# ü§ñ Regras de Integra√ß√£o de IA

## Arquitetura de Integra√ß√£o
- Integra√ß√£o via **Supabase Edge Functions** (`supabase/functions/openai-proxy/`)
- Chamadas atrav√©s de `supabase.functions.invoke('openai-proxy')`
- Utilit√°rios tipados em `src/utils/openai.ts`
- Hooks customizados em `src/hooks/useOpenAI.tsx`

## Padr√µes de Implementa√ß√£o
- **Nunca expor chaves da OpenAI** no frontend
- Todas as chamadas devem passar pela Edge Function
- Usar **tipagem forte** para requests e responses
- Implementar **cache inteligente** com React Query
- **Fallbacks obrigat√≥rios** para todas as opera√ß√µes de IA

## Tratamento de Erros
- Sempre tratar erros com try/catch
- Implementar fallbacks para opera√ß√µes cr√≠ticas
- Logs detalhados apenas no servidor (Edge Function)
- Estados de loading consistentes no frontend

## Casos de Uso Implementados
- Corre√ß√£o de texto (`correctText`)
- Melhoria de texto (`improveText`)
- An√°lise de contratos (`analyzeContracts`)
- Gera√ß√£o de imagens (`generateImage`)
- Chat conversacional (`chatCompletion`)
- An√°lise de imagens (`analyzeImage`)
- Gera√ß√£o de tarefas (`generateTask`)
- Extra√ß√£o de apontamentos (`extractApontamentos`)

## Performance
- Cache de respostas com React Query
- Timeout de 60 segundos para chamadas
- Debounce em opera√ß√µes de texto
- Otimiza√ß√£o de tokens por opera√ß√£o
