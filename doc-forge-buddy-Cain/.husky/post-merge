#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Post-merge hook para instalar dependÃªncias automaticamente
echo "ğŸ”„ Executando post-merge hook..."

# Verificar se o package.json foi alterado
if git diff --cached --name-only | grep -q "package.json"; then
    echo "ğŸ“¦ package.json foi alterado, verificando dependÃªncias..."
    
    if [ -f "package-lock.json" ] || [ -f "yarn.lock" ] || [ -f "pnpm-lock.yaml" ]; then
        echo "ğŸ“¥ Instalando dependÃªncias..."
        npm install
        
        if [ $? -eq 0 ]; then
            echo "âœ… DependÃªncias instaladas com sucesso!"
        else
            echo "âŒ Falha ao instalar dependÃªncias!"
            exit 1
        fi
    else
        echo "â„¹ï¸  Nenhum lockfile encontrado, pulando instalaÃ§Ã£o de dependÃªncias."
    fi
else
    echo "â„¹ï¸  package.json nÃ£o foi alterado, pulando post-merge."
fi